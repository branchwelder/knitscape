(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const o of s.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&i(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */var re;const zt=window,lt=zt.trustedTypes,Fe=lt?lt.createPolicy("lit-html",{createHTML:t=>t}):void 0,ue="$lit$",G=`lit$${(Math.random()+"").slice(9)}$`,En="?"+G,mi=`<${En}>`,j=document,_t=()=>j.createComment(""),wt=t=>t===null||typeof t!="object"&&typeof t!="function",Cn=Array.isArray,xi=t=>Cn(t)||typeof(t==null?void 0:t[Symbol.iterator])=="function",se=`[ 	
\f\r]`,ft=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,ze=/-->/g,We=/>/g,Y=RegExp(`>|${se}(?:([^\\s"'>=/]+)(${se}*=${se}*(?:[^ 	
\f\r"'\`<>=]|("|')|))|$)`,"g"),De=/'/g,Ge=/"/g,In=/^(?:script|style|textarea|title)$/i,_i=t=>(e,...n)=>({_$litType$:t,strings:e,values:n}),k=_i(1),F=Symbol.for("lit-noChange"),I=Symbol.for("lit-nothing"),Ue=new WeakMap,K=j.createTreeWalker(j,129,null,!1);function Bn(t,e){if(!Array.isArray(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return Fe!==void 0?Fe.createHTML(e):e}const wi=(t,e)=>{const n=t.length-1,i=[];let r,s=e===2?"<svg>":"",o=ft;for(let a=0;a<n;a++){const l=t[a];let c,u,f=-1,h=0;for(;h<l.length&&(o.lastIndex=h,u=o.exec(l),u!==null);)h=o.lastIndex,o===ft?u[1]==="!--"?o=ze:u[1]!==void 0?o=We:u[2]!==void 0?(In.test(u[2])&&(r=RegExp("</"+u[2],"g")),o=Y):u[3]!==void 0&&(o=Y):o===Y?u[0]===">"?(o=r??ft,f=-1):u[1]===void 0?f=-2:(f=o.lastIndex-u[2].length,c=u[1],o=u[3]===void 0?Y:u[3]==='"'?Ge:De):o===Ge||o===De?o=Y:o===ze||o===We?o=ft:(o=Y,r=void 0);const d=o===Y&&t[a+1].startsWith("/>")?" ":"";s+=o===ft?l+mi:f>=0?(i.push(c),l.slice(0,f)+ue+l.slice(f)+G+d):l+G+(f===-2?(i.push(void 0),a):d)}return[Bn(t,s+(t[n]||"<?>")+(e===2?"</svg>":"")),i]};class bt{constructor({strings:e,_$litType$:n},i){let r;this.parts=[];let s=0,o=0;const a=e.length-1,l=this.parts,[c,u]=wi(e,n);if(this.el=bt.createElement(c,i),K.currentNode=this.el.content,n===2){const f=this.el.content,h=f.firstChild;h.remove(),f.append(...h.childNodes)}for(;(r=K.nextNode())!==null&&l.length<a;){if(r.nodeType===1){if(r.hasAttributes()){const f=[];for(const h of r.getAttributeNames())if(h.endsWith(ue)||h.startsWith(G)){const d=u[o++];if(f.push(h),d!==void 0){const y=r.getAttribute(d.toLowerCase()+ue).split(G),g=/([.?@])?(.*)/.exec(d);l.push({type:1,index:s,name:g[2],strings:y,ctor:g[1]==="."?Ei:g[1]==="?"?Ii:g[1]==="@"?Bi:jt})}else l.push({type:6,index:s})}for(const h of f)r.removeAttribute(h)}if(In.test(r.tagName)){const f=r.textContent.split(G),h=f.length-1;if(h>0){r.textContent=lt?lt.emptyScript:"";for(let d=0;d<h;d++)r.append(f[d],_t()),K.nextNode(),l.push({type:2,index:++s});r.append(f[h],_t())}}}else if(r.nodeType===8)if(r.data===En)l.push({type:2,index:s});else{let f=-1;for(;(f=r.data.indexOf(G,f+1))!==-1;)l.push({type:7,index:s}),f+=G.length-1}s++}}static createElement(e,n){const i=j.createElement("template");return i.innerHTML=e,i}}function ct(t,e,n=t,i){var r,s,o,a;if(e===F)return e;let l=i!==void 0?(r=n._$Co)===null||r===void 0?void 0:r[i]:n._$Cl;const c=wt(e)?void 0:e._$litDirective$;return(l==null?void 0:l.constructor)!==c&&((s=l==null?void 0:l._$AO)===null||s===void 0||s.call(l,!1),c===void 0?l=void 0:(l=new c(t),l._$AT(t,n,i)),i!==void 0?((o=(a=n)._$Co)!==null&&o!==void 0?o:a._$Co=[])[i]=l:n._$Cl=l),l!==void 0&&(e=ct(t,l._$AS(t,e.values),l,i)),e}class bi{constructor(e,n){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=n}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){var n;const{el:{content:i},parts:r}=this._$AD,s=((n=e==null?void 0:e.creationScope)!==null&&n!==void 0?n:j).importNode(i,!0);K.currentNode=s;let o=K.nextNode(),a=0,l=0,c=r[0];for(;c!==void 0;){if(a===c.index){let u;c.type===2?u=new Nt(o,o.nextSibling,this,e):c.type===1?u=new c.ctor(o,c.name,c.strings,this,e):c.type===6&&(u=new Ni(o,this,e)),this._$AV.push(u),c=r[++l]}a!==(c==null?void 0:c.index)&&(o=K.nextNode(),a++)}return K.currentNode=j,s}v(e){let n=0;for(const i of this._$AV)i!==void 0&&(i.strings!==void 0?(i._$AI(e,i,n),n+=i.strings.length-2):i._$AI(e[n])),n++}}class Nt{constructor(e,n,i,r){var s;this.type=2,this._$AH=I,this._$AN=void 0,this._$AA=e,this._$AB=n,this._$AM=i,this.options=r,this._$Cp=(s=r==null?void 0:r.isConnected)===null||s===void 0||s}get _$AU(){var e,n;return(n=(e=this._$AM)===null||e===void 0?void 0:e._$AU)!==null&&n!==void 0?n:this._$Cp}get parentNode(){let e=this._$AA.parentNode;const n=this._$AM;return n!==void 0&&(e==null?void 0:e.nodeType)===11&&(e=n.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,n=this){e=ct(this,e,n),wt(e)?e===I||e==null||e===""?(this._$AH!==I&&this._$AR(),this._$AH=I):e!==this._$AH&&e!==F&&this._(e):e._$litType$!==void 0?this.g(e):e.nodeType!==void 0?this.$(e):xi(e)?this.T(e):this._(e)}k(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}$(e){this._$AH!==e&&(this._$AR(),this._$AH=this.k(e))}_(e){this._$AH!==I&&wt(this._$AH)?this._$AA.nextSibling.data=e:this.$(j.createTextNode(e)),this._$AH=e}g(e){var n;const{values:i,_$litType$:r}=e,s=typeof r=="number"?this._$AC(e):(r.el===void 0&&(r.el=bt.createElement(Bn(r.h,r.h[0]),this.options)),r);if(((n=this._$AH)===null||n===void 0?void 0:n._$AD)===s)this._$AH.v(i);else{const o=new bi(s,this),a=o.u(this.options);o.v(i),this.$(a),this._$AH=o}}_$AC(e){let n=Ue.get(e.strings);return n===void 0&&Ue.set(e.strings,n=new bt(e)),n}T(e){Cn(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let i,r=0;for(const s of e)r===n.length?n.push(i=new Nt(this.k(_t()),this.k(_t()),this,this.options)):i=n[r],i._$AI(s),r++;r<n.length&&(this._$AR(i&&i._$AB.nextSibling,r),n.length=r)}_$AR(e=this._$AA.nextSibling,n){var i;for((i=this._$AP)===null||i===void 0||i.call(this,!1,!0,n);e&&e!==this._$AB;){const r=e.nextSibling;e.remove(),e=r}}setConnected(e){var n;this._$AM===void 0&&(this._$Cp=e,(n=this._$AP)===null||n===void 0||n.call(this,e))}}class jt{constructor(e,n,i,r,s){this.type=1,this._$AH=I,this._$AN=void 0,this.element=e,this.name=n,this._$AM=r,this.options=s,i.length>2||i[0]!==""||i[1]!==""?(this._$AH=Array(i.length-1).fill(new String),this.strings=i):this._$AH=I}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,n=this,i,r){const s=this.strings;let o=!1;if(s===void 0)e=ct(this,e,n,0),o=!wt(e)||e!==this._$AH&&e!==F,o&&(this._$AH=e);else{const a=e;let l,c;for(e=s[0],l=0;l<s.length-1;l++)c=ct(this,a[i+l],n,l),c===F&&(c=this._$AH[l]),o||(o=!wt(c)||c!==this._$AH[l]),c===I?e=I:e!==I&&(e+=(c??"")+s[l+1]),this._$AH[l]=c}o&&!r&&this.j(e)}j(e){e===I?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}}class Ei extends jt{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===I?void 0:e}}const Ci=lt?lt.emptyScript:"";class Ii extends jt{constructor(){super(...arguments),this.type=4}j(e){e&&e!==I?this.element.setAttribute(this.name,Ci):this.element.removeAttribute(this.name)}}class Bi extends jt{constructor(e,n,i,r,s){super(e,n,i,r,s),this.type=5}_$AI(e,n=this){var i;if((e=(i=ct(this,e,n,0))!==null&&i!==void 0?i:I)===F)return;const r=this._$AH,s=e===I&&r!==I||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,o=e!==I&&(r===I||s);s&&this.element.removeEventListener(this.name,this,r),o&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var n,i;typeof this._$AH=="function"?this._$AH.call((i=(n=this.options)===null||n===void 0?void 0:n.host)!==null&&i!==void 0?i:this.element,e):this._$AH.handleEvent(e)}}class Ni{constructor(e,n,i){this.element=e,this.type=6,this._$AN=void 0,this._$AM=n,this.options=i}get _$AU(){return this._$AM._$AU}_$AI(e){ct(this,e)}}const $e=zt.litHtmlPolyfillSupport;$e==null||$e(bt,Nt),((re=zt.litHtmlVersions)!==null&&re!==void 0?re:zt.litHtmlVersions=[]).push("2.8.0");const U=(t,e,n)=>{var i,r;const s=(i=n==null?void 0:n.renderBefore)!==null&&i!==void 0?i:e;let o=s._$litPart$;if(o===void 0){const a=(r=n==null?void 0:n.renderBefore)!==null&&r!==void 0?r:null;s._$litPart$=o=new Nt(e.insertBefore(_t(),a),a,void 0,n??{})}return o._$AI(t),o};/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const it={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},Ri=t=>(...e)=>({_$litDirective$:t,values:e});class Ti{constructor(e){}get _$AU(){return this._$AM._$AU}_$AT(e,n,i){this._$Ct=e,this._$AM=n,this._$Ci=i}_$AS(e,n){return this.update(e,n)}update(e,n){return this.render(...n)}}/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Mi=t=>t.strings===void 0,ki={},Hi=(t,e=ki)=>t._$AH=e;/**
 * @license
 * Copyright 2020 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const Ce=Ri(class extends Ti{constructor(t){if(super(t),t.type!==it.PROPERTY&&t.type!==it.ATTRIBUTE&&t.type!==it.BOOLEAN_ATTRIBUTE)throw Error("The `live` directive is not allowed on child or event bindings");if(!Mi(t))throw Error("`live` bindings can only contain a single expression")}render(t){return t}update(t,[e]){if(e===F||e===I)return e;const n=t.element,i=t.name;if(t.type===it.PROPERTY){if(e===n[i])return F}else if(t.type===it.BOOLEAN_ATTRIBUTE){if(!!e===n.hasAttribute(i))return F}else if(t.type===it.ATTRIBUTE&&n.getAttribute(i)===e+"")return F;return Hi(t),e}});class C{constructor(e,n,i){this.width=e,this.height=n,this.pixels=new Uint8ClampedArray(i)}static fromJSON(e){return new C(e.width,e.height,e.pixels)}static empty(e,n,i){let r=new Array(e*n).fill(i);return new C(e,n,r)}static fromTile(e,n,i){let r=[];for(let s=0;s<n;s++)for(let o=0;o<e;o++)r.push(i.pixel(o%i.width,s%i.height));return new C(e,n,r)}pad(e,n,i){const r=Array(n*(this.width+2*e)).fill(i),s=Array(e).fill(i);let o=this.make2d();return new C(this.width+2*e,this.height+2*n,[...o.reduce((a,l)=>[...a,...s,...l,...s],[...r]),...r])}resize(e,n){let i=[];for(let r=0;r<n;r++)for(let s=0;s<e;s++)r>=this.height||s>=this.width?i.push(0):i.push(this.pixel(s,r));return new C(e,n,i)}make2d(){let e=Array.from(this.pixels).slice(),n=[];for(;e.length>0;)n.push(e.splice(0,this.width));return n}vMirror(){return new C(this.width,this.height,this.make2d().toReversed().flat())}pixel(e,n){return e>this.width-1||e<0||n>this.height-1||n<0?-1:this.pixels.at(e+n*this.width)}draw(e){let n=this.pixels.slice();for(let{x:i,y:r,color:s}of e)i<0||r<0||i>=this.width||r>=this.height||(n[i+r*this.width]=s);return new C(this.width,this.height,n)}brush({x:e,y:n},i){let r={x:e,y:n,color:i};return this.draw([r])}flood({x:e,y:n},i){const r=this.pixel(e,n);if(r===i)return this.draw([]);const s=[{dx:-1,dy:0},{dx:1,dy:0},{dx:0,dy:-1},{dx:0,dy:1}];let o=[{x:e,y:n,color:i}];for(let a=0;a<o.length;a++)for(let{dx:l,dy:c}of s){let u=o[a].x+l,f=o[a].y+c;u>=0&&u<this.width&&f>=0&&f<this.height&&this.pixel(u,f)==r&&!o.some(h=>h.x==u&&h.y==f)&&o.push({x:u,y:f,color:i})}return this.draw(o)}shift(e,n){let i=[];for(let r=0;r<this.height;r++)for(let s=0;s<this.width;s++)i.push({x:(s-e%this.width+this.width)%this.width,y:(r-n%this.height+this.height)%this.height,color:this.pixel(s,r)});return this.draw(i)}rect(e,n,i){let r=Math.min(e.x,n.x),s=Math.min(e.y,n.y),o=Math.max(e.x,n.x),a=Math.max(e.y,n.y),l=[];for(let c=s;c<=a;c++)for(let u=r;u<=o;u++)l.push({x:u,y:c,color:i});return this.draw(l)}line(e,n,i){let r=[];if(Math.abs(e.x-n.x)>Math.abs(e.y-n.y)){e.x>n.x&&([e,n]=[n,e]);let s=(n.y-e.y)/(n.x-e.x);for(let{x:o,y:a}=e;o<=n.x;o++)r.push({x:o,y:Math.round(a),color:i}),a+=s}else{e.y>n.y&&([e,n]=[n,e]);let s=(n.x-e.x)/(n.y-e.y);for(let{x:o,y:a}=e;a<=n.y;a++)r.push({x:Math.round(o),y:a,color:i}),o+=s}return this.draw(r)}}const Si=[];function Li(t,e){return{...t,...e}}const Pi={bitmap:C.empty(10,10,0),aspectRatio:[1,1],scale:1,pan:{x:0,y:0},canvas:document.createElement("canvas"),palette:["000000","#ffffff"]};class Ie{constructor({state:e,components:n=[],effects:i={}}){this.state={...Pi,...e},this.initialized=!1,this.effects=i,this.dispatch=r=>{const s=Object.keys(r);this.state=Li(this.state,r),s.forEach(o=>{o in this.effects&&this.effects[o].forEach(a=>a(this.state))}),this.syncState(this.state,s)},this.components=Si.concat(n.flat()).map(r=>r({state:this.state,dispatch:this.dispatch})),this.initialized=!0,this.components.forEach(r=>{"attached"in r&&r.attached(this.state)})}addEffect(e,n){this.effects[e]=[...this.effects[e]||[],n]}addComponent(e){const n=e({state:this.state,dispatch:this.dispatch});this.components.push(n),"attached"in e&&e.attached(state)}syncState(e){this.state=e,this.components.forEach(n=>{n.syncState(e)})}}function Ye(t){let e;return n=>n[t]!=e?(e=n[t],!0):!1}function Qi({state:t},{}){let{canvas:e,scale:n}=t,i,r;function s(o){e.width=o.bitmap.width*o.aspectRatio[0]*o.scale,e.height=o.bitmap.height*o.aspectRatio[1]*o.scale}return{attached(o){n=o.scale,i=o.bitmap.width,r=o.bitmap.height,s(o)},syncState(o){(o.bitmap.width!=i||o.bitmap.height!=r||o.scale!=n)&&(n=o.scale,i=o.bitmap.width,r=o.bitmap.height,s(o))}}}function Be(t={}){return e=>Qi(e,t)}function Xi({state:t,dispatch:e},{target:n}){t.pos={x:-1,y:-1};function i(r,s){const o=n.getBoundingClientRect(),a=Math.floor((r-o.x)/(t.aspectRatio[0]*t.scale)),l=Math.floor((s-o.y)/(t.aspectRatio[1]*t.scale));return{x:a,y:l}}return n.addEventListener("mousemove",r=>{const{x:s,y:o}=i(r.clientX,r.clientY);(t.pos.x!=s||t.pos.y!=o)&&e({pos:{x:s,y:o}})}),n.addEventListener("mouseleave",r=>{e({pos:{x:-1,y:-1}})}),{syncState(r){t=r}}}function Ne(t={}){return e=>Xi(e,t)}function Vi({state:t},{}){let{aspectRatio:e,scale:n,bitmap:i,canvas:r}=t,s=[e[0]*n,e[1]*n];function o(){const a=r.getContext("2d");a.save(),a.translate(-.5,-.5),a.beginPath();for(let l=1;l<i.width;l++)a.moveTo(l*s[0],0),a.lineTo(l*s[0],i.height*s[1]);for(let l=1;l<i.height;l++)a.moveTo(0,l*s[1]),a.lineTo(i.width*s[0],l*s[1]);a.stroke(),a.restore()}return{attached(a){({aspectRatio:e,scale:n,bitmap:i}=a),s=[e[0]*n,e[1]*n],o()},syncState(a){({aspectRatio:e,scale:n,bitmap:i}=a),s=[e[0]*n,e[1]*n],o()}}}function Re(t={}){return e=>Vi(e,t)}function Oi({state:t},{cell:e=!0,row:n=!1,col:i=!1,color:r="#00000044"}){let{aspectRatio:s,scale:o,bitmap:a,pos:l,pan:c,canvas:u}=t,f=[s[0]*o,s[1]*o];function h(){if(l.x<0||l.y<0)return;const d=u.getContext("2d");d.fillStyle=r,e&&d.fillRect(l.x*f[0],l.y*f[1],f[0],f[1]),n&&d.fillRect(0,l.y*f[1],f[0]*a.width,f[1]),i&&d.fillRect(l.x*f[0],0,f[0],f[1]*a.height)}return{syncState(d){(d.bitmap.width!=a.width||d.bitmap.height!=a.height||d.aspectRatio[0]!=s[0]||d.aspectRatio[1]!=s[1]||d.scale!=o||d.pos!=l)&&(l=d.pos,a=d.bitmap,s=d.aspectRatio,o=d.scale,c=d.pan,f=[s[0]*o,s[1]*o],h())}}}function Nn(t={}){return e=>Oi(e,t)}function Fi({state:t},{drawFunc:e,paletteOverride:n,bitmapOverride:i}){t.paletteIndex=0;let{aspectRatio:r,scale:s,bitmap:o,palette:a,canvas:l}=t;function c(u){const f=l.getContext("2d");f.imageSmoothingQuality="high",n&&(a=u[n]),i&&(o=u[i]);for(let h=0;h<o.height;h++)for(let d=0;d<o.width;d++){let y=o.pixel(d,h);f.translate(d*r[0]*s,h*r[1]*s),e(a[y],f,r[0]*s,r[1]*s),f.setTransform(1,0,0,1,0,0)}}return{attached(u){({aspectRatio:r,scale:s,bitmap:o,palette:a}=u),c(u)},syncState(u){({aspectRatio:r,scale:s,bitmap:o,palette:a}=u),c(u)}}}function Wt(t={}){return e=>Fi(e,t)}function Rn(t,e,n,i){e.fillStyle=t,e.fillRect(0,0,n,i)}function Tn(t,e,n,i){e.drawImage(t.image,0,0,n,i)}function zi({state:t,dispatch:e},{tools:n,eventTarget:i}){return t.activeTool=Object.keys(n)[0],i.addEventListener("pointerdown",r=>{let s=t.pos,o=n[t.activeTool],a=o(s,t,e);if(!a)return;let l=c=>{if(c.buttons==0)i.removeEventListener("mousemove",l);else{let u=t.pos;if(u.x==s.x&&u.y==s.y)return;a(t.pos,t),s=u}};i.addEventListener("mousemove",l)}),{syncState(r){t=r}}}function he(t={}){return e=>zi(e,t)}function Mn(t,e,n){function i(r,s){const o=s.bitmap.line({x:t.x,y:t.y},{x:r.x,y:r.y},s.paletteIndex);t=r,n({bitmap:o})}return i(t,e),i}function Wi(t,e,n){function i({x:r,y:s},o){n({bitmap:o.bitmap.flood({x:r,y:s},o.paletteIndex)})}return i(t,e),i}function Di(t,e,n){function i({x:r,y:s},o){const a=e.bitmap.rect({x:t.x,y:t.y},{x:r,y:s},e.paletteIndex);n({bitmap:a})}return i(t),i}function Gi(t,e,n){function i({x:r,y:s}){n({bitmap:e.bitmap.line({x:t.x,y:t.y},{x:r,y:s},e.paletteIndex)})}return i(t),i}function Ui(t,e,n){function i({x:r,y:s}){n({bitmap:e.bitmap.shift(t.x-r,t.y-s)})}return i(t),i}function $i({dispatch:t},{check:e=()=>!0,cb:n}){return{attached(i){e(i)&&n(i,t)},syncState(i){e(i)&&n(i,t)}}}function Q(t={}){return e=>$i(e,t)}const Yi=25,Zi={pixels:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,2,0,0,0,0,0,2],width:6,height:16},Ki={width:1,height:24,pixels:[0,0,0,0,0,0,1,1,2,2,2,2,2,2,1,1,3,3,3,3,3,3,1,1]},qi=["#f0dcb2","#2d436e","#5e8c66","#e0961d"],Ji={width:6,height:1,pixels:[0,0,0,0,0,0]},ji={scale:Yi,repeat:Zi,yarns:Ki,yarnPalette:qi,needles:Ji},tr="data:image/png;base64,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",kn="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkEAYAAAFXdXmBAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAuIwAALiMBeKU/dgAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAAZdEVYdEF1dGhvcgBIYW5uYWggVHdpZ2ctU21pdGgrm0NgAAAARHRFWHRDb3B5cmlnaHQAQ0MgQXR0cmlidXRpb24gaHR0cDovL2NyZWF0aXZlY29tbW9ucy5vcmcvbGljZW5zZXMvYnkvNC4wL2kQ110AAAF7SURBVHja7d0xctswEIZRgoP7n2z3TFIhlhxVBLjAvNek5Kw//ZbjJE77XI7BzmMSD6r/oJ6ZmTn+Qc3L24OmP2j4q+5c/kPlAe9/kvQy9YCF3mK3eXtwiEMc4hCHOMQhDvG1lkMc4hCHOMQhDnFIBdP+jMoXjTbiEIc4xCEOcYhDfK2FV5YgCCIIgiCIIAgiCIIIwmjt94vvZVXRfWvRpywEEQRBBEEQQRBEEARBkEX4i3IWgiCCIIggCCIIggiCIAgiCIIIgiCCIIggCIIggiCIIDxrm596uwv/CrfaQvy9Re8hCCIIggiCIIIgiCAIgiCCIIggCCIIggiCIAgiCIIIwqP8RDnwGQsMBAwEDAQMBAwEDAQMBAwEMBAwEDAQMBAwEDAQMBAwEDAQMBDAQMBAwEDAQKAC/4Ek/NEjIiJ8IOD2HcRPVgS/BwEDAQMBAwEDAQMBAwEDAQMBDAQMBAwEDAQMBAwEDAQMBAwEDAQwEDAQMBAwECjgC5KFgw/EKDwBAAAAAElFTkSuQmCC",Hn="data:image/png;base64,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",er="data:image/png;base64,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",nr="data:image/png;base64,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",ir="data:image/png;base64,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";async function rr(){const t=new Image;t.src=tr,await t.decode();const e=new Image;e.src=kn,await e.decode();const n=new Image;n.src=Hn,await n.decode();const i=new Image;return i.src=er,await i.decode(),[{image:t,title:"Knit"},{image:i,title:"Purl"},{image:e,title:"Slip"},{image:n,title:"Tuck"}]}async function sr(){const t=new Image;t.src=nr,await t.decode();const e=new Image;e.src=kn,await e.decode();const n=new Image;n.src=Hn,await n.decode();const i=new Image;return i.src=ir,await i.decode(),[{image:t,title:"Knit"},{image:i,title:"Purl"},{image:e,title:"Slip"},{image:n,title:"Tuck"}]}function Ze(){for(var t="0123456789ABCDEF",e="#",n=0;n<6;n++)e+=t[Math.floor(Math.random()*16)];return e}function or(t){return(e,n)=>U(k`
        <button
          style="aspect-ratio: 1;"
          @click=${()=>{let i=[...e.palette];i.push(Ze()),n({palette:i})}}>
          <i class="fa-solid fa-plus"></i>
        </button>

        <div class="palette-select">
          ${e.palette.map((i,r)=>k`<div
                style="background-color: ${i}"
                class="hex-select ${r==e.paletteIndex?"selected":""}"
                @click=${()=>n({paletteIndex:r})}>
                <label class="edit-color" for="color-${r}">
                  <i class="fa-solid fa-pen"></i>
                </label>
                <input
                  id="color-${r}"
                  type="color"
                  value="${i}"
                  @input=${s=>{let o=[...e.palette];o[r]=s.target.value,n({palette:o})}} />
              </div>`)}
        </div>

        <button
          style="aspect-ratio: 1;"
          @click=${()=>{n({palette:Array.from(Array(e.palette.length),()=>Ze())})}}>
          <i class="fa-solid fa-arrows-rotate"></i>
        </button>
      `,t)}function ar({container:t}){return(e,n)=>{let{bitmap:i}=e;U(k`<div class="spinner vertical">
        <button
          class="plus"
          @click=${()=>n({bitmap:i.vMirror().resize(i.width,i.height+1).vMirror()})}>
          <i class="fa-solid fa-plus"></i>
        </button>
        <input
          type="text"
          .value=${Ce(i.height)}
          class="size-input"
          @change=${r=>n({bitmap:i.vMirror().resize(i.width,Number(r.target.value)).vMirror()})} />

        <button
          class="minus"
          @click=${()=>n({bitmap:i.vMirror().resize(i.width,i.height-1).vMirror()})}>
          <i class="fa-solid fa-minus"></i>
        </button>
      </div>`,t)}}function lr(t,e){return new Ie({state:{bitmap:C.fromJSON(t.yarns).vMirror(),palette:t.yarnPalette,canvas:e},components:[Ne({target:e}),Be(),Wt({drawFunc:Rn}),Re(),he({tools:{brush:Mn},eventTarget:e}),Q({cb:ar({container:document.getElementById("color-height")})}),Q({cb:or(document.getElementById("yarn-palette"))})]})}const fe="ECN",At="PCN",rt="ACN",dt="UACN",cr="K",ur="P",Ke="T",qe="M";class hr{constructor(e,n,i=!0){if(this.width=2*e,this.height=n+1,this.contacts=Array.from({length:this.width*this.height},()=>[null,fe,[null,null]]),i)for(let r=0;r<this.width;r++)this.setAV(r,0,At),this.setMV(r,0,[0,0])}getST(e,n){return this.neighborhood(e,n)[0]}setSt(e,n,i){this.neighborhood(e,n)[0]=i}getAV(e,n){return this.neighborhood(e,n)[1]}setAV(e,n,i){this.neighborhood(e,n)[1]=i}getMV(e,n){return this.neighborhood(e,n)[2]}getDeltaI(e,n){return this.neighborhood(e,n)[2][0]}getDeltaJ(e,n){return this.neighborhood(e,n)[2][1]}setMV(e,n,i){this.neighborhood(e,n)[2]=i}setDeltaJ(e,n,i){this.neighborhood(e,n)[2][1]=i}setDeltaI(e,n,i){this.neighborhood(e,n)[2][0]=i}neighborhood(e,n){return this.contacts[n*this.width+e]}}class fr{constructor(e){this.instructions=e,this.width=e.width,this.height=e.height,this.cn=new hr(this.width,this.height),this.populateContacts()}handleKPLower(e,n,i){this.cn.setSt(e,n,i);const r=this.cn.getAV(e,n),s=this.cn.getMV(e,n);r==At&&s[0]===0&&this.cn.setAV(e,n,rt),r==dt&&((this.cn.getAV(e+1,n-1)==rt&&this.cn.getMV(e+1,n-1)[1]==0||this.cn.getAV(e-1,n-1)==rt&&this.cn.getMV(e-1,n-1)[1]==0)&&this.cn.setAV(e,n,rt),this.cn.getAV(e,n-1)==At&&this.cn.setAV(e,n-1,rt))}handleKPUpper(e,n){this.cn.setMV(e,n+1,[0,0]),this.cn.getAV(e,n)==rt?this.cn.setAV(e,n+1,At):this.cn.setAV(e,n+1,dt),this.cn.getAV(e,n)==dt}handleTuckMissUpper(e,n,i){i==Ke?(this.cn.setAV(e,n+1,dt),this.cn.setMV(e,n+1,[0,0])):i==qe&&(this.cn.setAV(e,n+1,fe),this.cn.setMV(e,n+1,[0,-1]))}handleTuckMissLower(e,n,i){const r=this.cn.getAV(e,n);if(r==At||r==dt)this.cn.setDeltaJ(e,n,1);else if(r==fe){let s=!1,o=0,a=0;for(;!s;){const l=this.cn.getMV(e,n-o)[1];if(l>0&&(this.cn.setDeltaJ(e,n-o,l+1),s=!0),o++,a++,a>1e3){console.error("COULDN'T FIND STITCH");break}}}}handleOp(e,n,i,r){(i==cr||i==ur)&&(this.handleKPLower(e,n,i),this.handleKPLower(e+r,n,i),this.handleKPUpper(e,n,i),this.handleKPUpper(e+r,n,i)),(i==Ke||i==qe)&&(this.handleTuckMissLower(e,n,i),this.handleTuckMissLower(e+r,n,i),this.handleTuckMissUpper(e,n,i),this.handleTuckMissUpper(e+r,n,i))}processRow(e,n){if(n)for(let i=0;i<this.width;i++){const r=this.instructions.op(i,e);this.handleOp(2*i,e,r,1)}else for(let i=this.width-1;i>=0;i--){const r=this.instructions.op(i,e);this.handleOp(2*i+1,e,r,-1)}}populateContacts(){let e=!0;for(let n=0;n<this.height;n++)this.processRow(n,e),e=!e}}const dr={T:0,K:1,S:2,p:3},pr=["K","P","M","T"];class gr{constructor(e){this.width=e.width,this.height=e.height,this.ops=Array.from(e.pixels).map(n=>pr[n]).toReversed()}op(e,n){return e>this.width-1||e<0||n>this.height-1||n<0?-1:this.ops.at(e+n*this.width)}makeOpData(){const e=this.width,n=this.height,i=[];for(let r=0;r<n;r++)for(let s=0;s<e;s++){const o=r*e+s,a=this.op(s,r),l=[[2*s,r],[2*s+1,r],[2*s+1,r+1],[2*s,r+1]];i.push({index:o,stitch:a,op:dr[a],cnIndices:l.map(([c,u])=>u*2*e+c)})}return i}}const Sn="K",Ln="P",Ar="ECN",Je="ACN",vr="UACN";function yr(t){let e=0,n=0,i=!0,r=0;const s=[];for(;n<t.height;){const o=r%2==0,a=e%2==0,l=o===a?"F":"L";if(mr(e,n,i,s,t)){let c;if(i)c=[e,n,r,l+"L"];else{const u=Pn(e,n,t);c=[u.i,u.j,r,l+"H"]}s.push(c)}({i:e,j:n,legNode:i,currentStitchRow:r}=Qn(e,n,i,r,t))}return s}function mr(t,e,n,i,r){if(n)return r.getST(t,e)==Sn||r.getST(t,e)==Ln;{let s=r.getAV(t,e);if(s==Ar)return!1;if(s==vr){let o,a,l,c;if(t%2==0&&e%2!=0)[o,a,l,c]=i.at(-1);else{let f=!1,h=t,d=e,y=n,g=e-1;for(;!f;){const p=Qn(h,d,y,g,r);r.getAV(p.i,p.j)==Je&&(f=!0),h=p.i,d=p.j,y=p.legNode,g=p.currentStitchRow}o=h,a=d}const u=Pn(t,e,r);return a<u.j?(r.setAV(t,e,Je),!0):!1}else return!0}}function Pn(t,e,n){const[i,r]=n.getMV(t,e);return e==n.height-1?{i:t,j:e}:i!=0?de(t+i,e,n):de(t,e+r,n)}function de(t,e,n){return n.getST(t,e)==Sn||n.getST(t,e)==Ln?{i:t,j:e}:e==n.height-1?{i:t,j:e}:de(t,e+n.getDeltaJ(t,e),n)}function Qn(t,e,n,i,r){const s=i%2==0,o=t%2==0;let a=t,l=e,c=n;return n?s?o?(l=e+1,c=!1):a=t+1:o?a=t-1:(l=e+1,c=!1):s?o?a=t+1:(l=e-1,c=!0):o?(l=e-1,c=!0):a=t-1,a<0||a>=r.width?{i:t,j:e+1,legNode:!0,currentStitchRow:i+1}:{i:a,j:l,legNode:c,currentStitchRow:i}}class xr{constructor(e){this.width=e.width,this.height=e.height,this.cns=e,this.contactNodes=e.contacts.map((n,i)=>({index:i,st:n[0],cn:n[1],mv:n[2]})),this.yarnPath=yr(e)}yarnPathToLinks(){let e=0,n=this.yarnPath[0][3];const i=[];return this.yarnPath.forEach(([r,s,o,a],l)=>{if(l==0)return;let c=s*this.width+r;i.push({source:e,target:c,row:o,linkType:n+a,index:l-1}),e=c,n=a}),i}makeNice(){return this.yarnPath.map(([e,n,i,r])=>({cnIndex:n*this.width+e,i:e,j:n,row:i,cnType:r,angle:null,normal:[0,0]}))}}function oe(t){return function(){return t}}function je(t){return(t()-.5)*1e-6}function _r(t){return t.index}function tn(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function wr(t){var e=_r,n=f,i,r=oe(30),s,o,a,l,c,u=1;t==null&&(t=[]);function f(p){return 1/Math.min(a[p.source.index],a[p.target.index])}function h(p){for(var v=0,m=t.length;v<u;++v)for(var w=0,x,b,B,T,H,N,W;w<m;++w)x=t[w],b=x.source,B=x.target,T=B.x+B.vx-b.x-b.vx||je(c),H=B.y+B.vy-b.y-b.vy||je(c),N=Math.sqrt(T*T+H*H),x.linkType=="FLFH"||x.linkType=="LHLL"?Math.sign(N-s[w])<=0?N=(N-s[w])/N*p*.001:N=(N-s[w])/N*p*.2:N=(N-s[w])/N*p*.5,T*=N,H*=N,B.vx-=T*(W=l[w]),B.vy-=H*W,b.vx+=T*(W=1-W),b.vy+=H*W}function d(){if(o){var p,v=o.length,m=t.length,w=new Map(o.map((b,B)=>[e(b,B,o),b])),x;for(p=0,a=new Array(v);p<m;++p)x=t[p],x.index=p,typeof x.source!="object"&&(x.source=tn(w,x.source)),typeof x.target!="object"&&(x.target=tn(w,x.target)),a[x.source.index]=(a[x.source.index]||0)+1,a[x.target.index]=(a[x.target.index]||0)+1;for(p=0,l=new Array(m);p<m;++p)x=t[p],l[p]=a[x.source.index]/(a[x.source.index]+a[x.target.index]);i=new Array(m),y(),s=new Array(m),g()}}function y(){if(o)for(var p=0,v=t.length;p<v;++p)i[p]=+n(t[p],p,t)}function g(){if(o)for(var p=0,v=t.length;p<v;++p)s[p]=+r(t[p],p,t)}return h.initialize=function(p,v){o=p,c=v,d()},h.links=function(p){return arguments.length?(t=p,d(),h):t},h.id=function(p){return arguments.length?(e=p,h):e},h.iterations=function(p){return arguments.length?(u=+p,h):u},h.strength=function(p){return arguments.length?(n=typeof p=="function"?p:oe(+p),y(),h):n},h.distance=function(p){return arguments.length?(r=typeof p=="function"?p:oe(+p),g(),h):r},h}var br={value:()=>{}};function Te(){for(var t=0,e=arguments.length,n={},i;t<e;++t){if(!(i=arguments[t]+"")||i in n||/[\s.]/.test(i))throw new Error("illegal type: "+i);n[i]=[]}return new Xt(n)}function Xt(t){this._=t}function Er(t,e){return t.trim().split(/^|\s+/).map(function(n){var i="",r=n.indexOf(".");if(r>=0&&(i=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:i}})}Xt.prototype=Te.prototype={constructor:Xt,on:function(t,e){var n=this._,i=Er(t+"",n),r,s=-1,o=i.length;if(arguments.length<2){for(;++s<o;)if((r=(t=i[s]).type)&&(r=Cr(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<o;)if(r=(t=i[s]).type)n[r]=en(n[r],t.name,e);else if(e==null)for(r in n)n[r]=en(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Xt(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),i=0,r,s;i<r;++i)n[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],i=0,r=s.length;i<r;++i)s[i].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,s=i.length;r<s;++r)i[r].value.apply(e,n)}};function Cr(t,e){for(var n=0,i=t.length,r;n<i;++n)if((r=t[n]).name===e)return r.value}function en(t,e,n){for(var i=0,r=t.length;i<r;++i)if(t[i].name===e){t[i]=br,t=t.slice(0,i).concat(t.slice(i+1));break}return n!=null&&t.push({name:e,value:n}),t}var pe="http://www.w3.org/1999/xhtml";const nn={svg:"http://www.w3.org/2000/svg",xhtml:pe,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function te(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),nn.hasOwnProperty(e)?{space:nn[e],local:t}:t}function Ir(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===pe&&e.documentElement.namespaceURI===pe?e.createElement(t):e.createElementNS(n,t)}}function Br(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Xn(t){var e=te(t);return(e.local?Br:Ir)(e)}function Nr(){}function Me(t){return t==null?Nr:function(){return this.querySelector(t)}}function Rr(t){typeof t!="function"&&(t=Me(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],o=s.length,a=i[r]=new Array(o),l,c,u=0;u<o;++u)(l=s[u])&&(c=t.call(l,l.__data__,u,s))&&("__data__"in l&&(c.__data__=l.__data__),a[u]=c);return new M(i,this._parents)}function Tr(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function Mr(){return[]}function Vn(t){return t==null?Mr:function(){return this.querySelectorAll(t)}}function kr(t){return function(){return Tr(t.apply(this,arguments))}}function Hr(t){typeof t=="function"?t=kr(t):t=Vn(t);for(var e=this._groups,n=e.length,i=[],r=[],s=0;s<n;++s)for(var o=e[s],a=o.length,l,c=0;c<a;++c)(l=o[c])&&(i.push(t.call(l,l.__data__,c,o)),r.push(l));return new M(i,r)}function On(t){return function(){return this.matches(t)}}function Fn(t){return function(e){return e.matches(t)}}var Sr=Array.prototype.find;function Lr(t){return function(){return Sr.call(this.children,t)}}function Pr(){return this.firstElementChild}function Qr(t){return this.select(t==null?Pr:Lr(typeof t=="function"?t:Fn(t)))}var Xr=Array.prototype.filter;function Vr(){return Array.from(this.children)}function Or(t){return function(){return Xr.call(this.children,t)}}function Fr(t){return this.selectAll(t==null?Vr:Or(typeof t=="function"?t:Fn(t)))}function zr(t){typeof t!="function"&&(t=On(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],o=s.length,a=i[r]=[],l,c=0;c<o;++c)(l=s[c])&&t.call(l,l.__data__,c,s)&&a.push(l);return new M(i,this._parents)}function zn(t){return new Array(t.length)}function Wr(){return new M(this._enter||this._groups.map(zn),this._parents)}function Dt(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}Dt.prototype={constructor:Dt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Dr(t){return function(){return t}}function Gr(t,e,n,i,r,s){for(var o=0,a,l=e.length,c=s.length;o<c;++o)(a=e[o])?(a.__data__=s[o],i[o]=a):n[o]=new Dt(t,s[o]);for(;o<l;++o)(a=e[o])&&(r[o]=a)}function Ur(t,e,n,i,r,s,o){var a,l,c=new Map,u=e.length,f=s.length,h=new Array(u),d;for(a=0;a<u;++a)(l=e[a])&&(h[a]=d=o.call(l,l.__data__,a,e)+"",c.has(d)?r[a]=l:c.set(d,l));for(a=0;a<f;++a)d=o.call(t,s[a],a,s)+"",(l=c.get(d))?(i[a]=l,l.__data__=s[a],c.delete(d)):n[a]=new Dt(t,s[a]);for(a=0;a<u;++a)(l=e[a])&&c.get(h[a])===l&&(r[a]=l)}function $r(t){return t.__data__}function Yr(t,e){if(!arguments.length)return Array.from(this,$r);var n=e?Ur:Gr,i=this._parents,r=this._groups;typeof t!="function"&&(t=Dr(t));for(var s=r.length,o=new Array(s),a=new Array(s),l=new Array(s),c=0;c<s;++c){var u=i[c],f=r[c],h=f.length,d=Zr(t.call(u,u&&u.__data__,c,i)),y=d.length,g=a[c]=new Array(y),p=o[c]=new Array(y),v=l[c]=new Array(h);n(u,f,g,p,v,d,e);for(var m=0,w=0,x,b;m<y;++m)if(x=g[m]){for(m>=w&&(w=m+1);!(b=p[w])&&++w<y;);x._next=b||null}}return o=new M(o,i),o._enter=a,o._exit=l,o}function Zr(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Kr(){return new M(this._exit||this._groups.map(zn),this._parents)}function qr(t,e,n){var i=this.enter(),r=this,s=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),n==null?s.remove():n(s),i&&r?i.merge(r).order():r}function Jr(t){for(var e=t.selection?t.selection():t,n=this._groups,i=e._groups,r=n.length,s=i.length,o=Math.min(r,s),a=new Array(r),l=0;l<o;++l)for(var c=n[l],u=i[l],f=c.length,h=a[l]=new Array(f),d,y=0;y<f;++y)(d=c[y]||u[y])&&(h[y]=d);for(;l<r;++l)a[l]=n[l];return new M(a,this._parents)}function jr(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var i=t[e],r=i.length-1,s=i[r],o;--r>=0;)(o=i[r])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function ts(t){t||(t=es);function e(f,h){return f&&h?t(f.__data__,h.__data__):!f-!h}for(var n=this._groups,i=n.length,r=new Array(i),s=0;s<i;++s){for(var o=n[s],a=o.length,l=r[s]=new Array(a),c,u=0;u<a;++u)(c=o[u])&&(l[u]=c);l.sort(e)}return new M(r,this._parents).order()}function es(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function ns(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function is(){return Array.from(this)}function rs(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length;r<s;++r){var o=i[r];if(o)return o}return null}function ss(){let t=0;for(const e of this)++t;return t}function os(){return!this.node()}function as(t){for(var e=this._groups,n=0,i=e.length;n<i;++n)for(var r=e[n],s=0,o=r.length,a;s<o;++s)(a=r[s])&&t.call(a,a.__data__,s,r);return this}function ls(t){return function(){this.removeAttribute(t)}}function cs(t){return function(){this.removeAttributeNS(t.space,t.local)}}function us(t,e){return function(){this.setAttribute(t,e)}}function hs(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function fs(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function ds(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function ps(t,e){var n=te(t);if(arguments.length<2){var i=this.node();return n.local?i.getAttributeNS(n.space,n.local):i.getAttribute(n)}return this.each((e==null?n.local?cs:ls:typeof e=="function"?n.local?ds:fs:n.local?hs:us)(n,e))}function Wn(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function gs(t){return function(){this.style.removeProperty(t)}}function As(t,e,n){return function(){this.style.setProperty(t,e,n)}}function vs(t,e,n){return function(){var i=e.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,n)}}function ys(t,e,n){return arguments.length>1?this.each((e==null?gs:typeof e=="function"?vs:As)(t,e,n??"")):ut(this.node(),t)}function ut(t,e){return t.style.getPropertyValue(e)||Wn(t).getComputedStyle(t,null).getPropertyValue(e)}function ms(t){return function(){delete this[t]}}function xs(t,e){return function(){this[t]=e}}function _s(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function ws(t,e){return arguments.length>1?this.each((e==null?ms:typeof e=="function"?_s:xs)(t,e)):this.node()[t]}function Dn(t){return t.trim().split(/^|\s+/)}function ke(t){return t.classList||new Gn(t)}function Gn(t){this._node=t,this._names=Dn(t.getAttribute("class")||"")}Gn.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Un(t,e){for(var n=ke(t),i=-1,r=e.length;++i<r;)n.add(e[i])}function $n(t,e){for(var n=ke(t),i=-1,r=e.length;++i<r;)n.remove(e[i])}function bs(t){return function(){Un(this,t)}}function Es(t){return function(){$n(this,t)}}function Cs(t,e){return function(){(e.apply(this,arguments)?Un:$n)(this,t)}}function Is(t,e){var n=Dn(t+"");if(arguments.length<2){for(var i=ke(this.node()),r=-1,s=n.length;++r<s;)if(!i.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?Cs:e?bs:Es)(n,e))}function Bs(){this.textContent=""}function Ns(t){return function(){this.textContent=t}}function Rs(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function Ts(t){return arguments.length?this.each(t==null?Bs:(typeof t=="function"?Rs:Ns)(t)):this.node().textContent}function Ms(){this.innerHTML=""}function ks(t){return function(){this.innerHTML=t}}function Hs(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function Ss(t){return arguments.length?this.each(t==null?Ms:(typeof t=="function"?Hs:ks)(t)):this.node().innerHTML}function Ls(){this.nextSibling&&this.parentNode.appendChild(this)}function Ps(){return this.each(Ls)}function Qs(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Xs(){return this.each(Qs)}function Vs(t){var e=typeof t=="function"?t:Xn(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function Os(){return null}function Fs(t,e){var n=typeof t=="function"?t:Xn(t),i=e==null?Os:typeof e=="function"?e:Me(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),i.apply(this,arguments)||null)})}function zs(){var t=this.parentNode;t&&t.removeChild(this)}function Ws(){return this.each(zs)}function Ds(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Gs(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function Us(t){return this.select(t?Gs:Ds)}function $s(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Ys(t){return function(e){t.call(this,e,this.__data__)}}function Zs(t){return t.trim().split(/^|\s+/).map(function(e){var n="",i=e.indexOf(".");return i>=0&&(n=e.slice(i+1),e=e.slice(0,i)),{type:e,name:n}})}function Ks(t){return function(){var e=this.__on;if(e){for(var n=0,i=-1,r=e.length,s;n<r;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++i]=s;++i?e.length=i:delete this.__on}}}function qs(t,e,n){return function(){var i=this.__on,r,s=Ys(e);if(i){for(var o=0,a=i.length;o<a;++o)if((r=i[o]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=s,r.options=n),r.value=e;return}}this.addEventListener(t.type,s,n),r={type:t.type,name:t.name,value:e,listener:s,options:n},i?i.push(r):this.__on=[r]}}function Js(t,e,n){var i=Zs(t+""),r,s=i.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,u;l<c;++l)for(r=0,u=a[l];r<s;++r)if((o=i[r]).type===u.type&&o.name===u.name)return u.value}return}for(a=e?qs:Ks,r=0;r<s;++r)this.each(a(i[r],e,n));return this}function Yn(t,e,n){var i=Wn(t),r=i.CustomEvent;typeof r=="function"?r=new r(e,n):(r=i.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function js(t,e){return function(){return Yn(this,t,e)}}function to(t,e){return function(){return Yn(this,t,e.apply(this,arguments))}}function eo(t,e){return this.each((typeof e=="function"?to:js)(t,e))}function*no(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var i=t[e],r=0,s=i.length,o;r<s;++r)(o=i[r])&&(yield o)}var Zn=[null];function M(t,e){this._groups=t,this._parents=e}function Rt(){return new M([[document.documentElement]],Zn)}function io(){return this}M.prototype=Rt.prototype={constructor:M,select:Rr,selectAll:Hr,selectChild:Qr,selectChildren:Fr,filter:zr,data:Yr,enter:Wr,exit:Kr,join:qr,merge:Jr,selection:io,order:jr,sort:ts,call:ns,nodes:is,node:rs,size:ss,empty:os,each:as,attr:ps,style:ys,property:ws,classed:Is,text:Ts,html:Ss,raise:Ps,lower:Xs,append:Vs,insert:Fs,remove:Ws,clone:Us,datum:$s,on:Js,dispatch:eo,[Symbol.iterator]:no};function ro(t){return typeof t=="string"?new M([[document.querySelector(t)]],[document.documentElement]):new M([[t]],Zn)}function He(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Kn(t,e){var n=Object.create(t.prototype);for(var i in e)n[i]=e[i];return n}function Tt(){}var Et=.7,Gt=1/Et,ot="\\s*([+-]?\\d+)\\s*",Ct="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",X="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",so=/^#([0-9a-f]{3,8})$/,oo=new RegExp(`^rgb\\(${ot},${ot},${ot}\\)$`),ao=new RegExp(`^rgb\\(${X},${X},${X}\\)$`),lo=new RegExp(`^rgba\\(${ot},${ot},${ot},${Ct}\\)$`),co=new RegExp(`^rgba\\(${X},${X},${X},${Ct}\\)$`),uo=new RegExp(`^hsl\\(${Ct},${X},${X}\\)$`),ho=new RegExp(`^hsla\\(${Ct},${X},${X},${Ct}\\)$`),rn={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};He(Tt,It,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:sn,formatHex:sn,formatHex8:fo,formatHsl:po,formatRgb:on,toString:on});function sn(){return this.rgb().formatHex()}function fo(){return this.rgb().formatHex8()}function po(){return qn(this).formatHsl()}function on(){return this.rgb().formatRgb()}function It(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=so.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?an(e):n===3?new R(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Ht(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Ht(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=oo.exec(t))?new R(e[1],e[2],e[3],1):(e=ao.exec(t))?new R(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=lo.exec(t))?Ht(e[1],e[2],e[3],e[4]):(e=co.exec(t))?Ht(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=uo.exec(t))?un(e[1],e[2]/100,e[3]/100,1):(e=ho.exec(t))?un(e[1],e[2]/100,e[3]/100,e[4]):rn.hasOwnProperty(t)?an(rn[t]):t==="transparent"?new R(NaN,NaN,NaN,0):null}function an(t){return new R(t>>16&255,t>>8&255,t&255,1)}function Ht(t,e,n,i){return i<=0&&(t=e=n=NaN),new R(t,e,n,i)}function go(t){return t instanceof Tt||(t=It(t)),t?(t=t.rgb(),new R(t.r,t.g,t.b,t.opacity)):new R}function ge(t,e,n,i){return arguments.length===1?go(t):new R(t,e,n,i??1)}function R(t,e,n,i){this.r=+t,this.g=+e,this.b=+n,this.opacity=+i}He(R,ge,Kn(Tt,{brighter(t){return t=t==null?Gt:Math.pow(Gt,t),new R(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Et:Math.pow(Et,t),new R(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new R(J(this.r),J(this.g),J(this.b),Ut(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:ln,formatHex:ln,formatHex8:Ao,formatRgb:cn,toString:cn}));function ln(){return`#${q(this.r)}${q(this.g)}${q(this.b)}`}function Ao(){return`#${q(this.r)}${q(this.g)}${q(this.b)}${q((isNaN(this.opacity)?1:this.opacity)*255)}`}function cn(){const t=Ut(this.opacity);return`${t===1?"rgb(":"rgba("}${J(this.r)}, ${J(this.g)}, ${J(this.b)}${t===1?")":`, ${t})`}`}function Ut(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function J(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function q(t){return t=J(t),(t<16?"0":"")+t.toString(16)}function un(t,e,n,i){return i<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new L(t,e,n,i)}function qn(t){if(t instanceof L)return new L(t.h,t.s,t.l,t.opacity);if(t instanceof Tt||(t=It(t)),!t)return new L;if(t instanceof L)return t;t=t.rgb();var e=t.r/255,n=t.g/255,i=t.b/255,r=Math.min(e,n,i),s=Math.max(e,n,i),o=NaN,a=s-r,l=(s+r)/2;return a?(e===s?o=(n-i)/a+(n<i)*6:n===s?o=(i-e)/a+2:o=(e-n)/a+4,a/=l<.5?s+r:2-s-r,o*=60):a=l>0&&l<1?0:o,new L(o,a,l,t.opacity)}function vo(t,e,n,i){return arguments.length===1?qn(t):new L(t,e,n,i??1)}function L(t,e,n,i){this.h=+t,this.s=+e,this.l=+n,this.opacity=+i}He(L,vo,Kn(Tt,{brighter(t){return t=t==null?Gt:Math.pow(Gt,t),new L(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Et:Math.pow(Et,t),new L(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,i=n+(n<.5?n:1-n)*e,r=2*n-i;return new R(ae(t>=240?t-240:t+120,r,i),ae(t,r,i),ae(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new L(hn(this.h),St(this.s),St(this.l),Ut(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Ut(this.opacity);return`${t===1?"hsl(":"hsla("}${hn(this.h)}, ${St(this.s)*100}%, ${St(this.l)*100}%${t===1?")":`, ${t})`}`}}));function hn(t){return t=(t||0)%360,t<0?t+360:t}function St(t){return Math.max(0,Math.min(1,t||0))}function ae(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Jn=t=>()=>t;function yo(t,e){return function(n){return t+n*e}}function mo(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(i){return Math.pow(t+i*e,n)}}function xo(t){return(t=+t)==1?jn:function(e,n){return n-e?mo(e,n,t):Jn(isNaN(e)?n:e)}}function jn(t,e){var n=e-t;return n?yo(t,n):Jn(isNaN(t)?e:t)}const fn=function t(e){var n=xo(e);function i(r,s){var o=n((r=ge(r)).r,(s=ge(s)).r),a=n(r.g,s.g),l=n(r.b,s.b),c=jn(r.opacity,s.opacity);return function(u){return r.r=o(u),r.g=a(u),r.b=l(u),r.opacity=c(u),r+""}}return i.gamma=t,i}(1);function D(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var Ae=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,le=new RegExp(Ae.source,"g");function _o(t){return function(){return t}}function wo(t){return function(e){return t(e)+""}}function bo(t,e){var n=Ae.lastIndex=le.lastIndex=0,i,r,s,o=-1,a=[],l=[];for(t=t+"",e=e+"";(i=Ae.exec(t))&&(r=le.exec(e));)(s=r.index)>n&&(s=e.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(i=i[0])===(r=r[0])?a[o]?a[o]+=r:a[++o]=r:(a[++o]=null,l.push({i:o,x:D(i,r)})),n=le.lastIndex;return n<e.length&&(s=e.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?l[0]?wo(l[0].x):_o(e):(e=l.length,function(c){for(var u=0,f;u<e;++u)a[(f=l[u]).i]=f.x(c);return a.join("")})}var dn=180/Math.PI,ve={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ti(t,e,n,i,r,s){var o,a,l;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(l=t*n+e*i)&&(n-=t*l,i-=e*l),(a=Math.sqrt(n*n+i*i))&&(n/=a,i/=a,l/=a),t*i<e*n&&(t=-t,e=-e,l=-l,o=-o),{translateX:r,translateY:s,rotate:Math.atan2(e,t)*dn,skewX:Math.atan(l)*dn,scaleX:o,scaleY:a}}var Lt;function Eo(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?ve:ti(e.a,e.b,e.c,e.d,e.e,e.f)}function Co(t){return t==null||(Lt||(Lt=document.createElementNS("http://www.w3.org/2000/svg","g")),Lt.setAttribute("transform",t),!(t=Lt.transform.baseVal.consolidate()))?ve:(t=t.matrix,ti(t.a,t.b,t.c,t.d,t.e,t.f))}function ei(t,e,n,i){function r(c){return c.length?c.pop()+" ":""}function s(c,u,f,h,d,y){if(c!==f||u!==h){var g=d.push("translate(",null,e,null,n);y.push({i:g-4,x:D(c,f)},{i:g-2,x:D(u,h)})}else(f||h)&&d.push("translate("+f+e+h+n)}function o(c,u,f,h){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),h.push({i:f.push(r(f)+"rotate(",null,i)-2,x:D(c,u)})):u&&f.push(r(f)+"rotate("+u+i)}function a(c,u,f,h){c!==u?h.push({i:f.push(r(f)+"skewX(",null,i)-2,x:D(c,u)}):u&&f.push(r(f)+"skewX("+u+i)}function l(c,u,f,h,d,y){if(c!==f||u!==h){var g=d.push(r(d)+"scale(",null,",",null,")");y.push({i:g-4,x:D(c,f)},{i:g-2,x:D(u,h)})}else(f!==1||h!==1)&&d.push(r(d)+"scale("+f+","+h+")")}return function(c,u){var f=[],h=[];return c=t(c),u=t(u),s(c.translateX,c.translateY,u.translateX,u.translateY,f,h),o(c.rotate,u.rotate,f,h),a(c.skewX,u.skewX,f,h),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,f,h),c=u=null,function(d){for(var y=-1,g=h.length,p;++y<g;)f[(p=h[y]).i]=p.x(d);return f.join("")}}}var Io=ei(Eo,"px, ","px)","deg)"),Bo=ei(Co,", ",")",")"),ht=0,vt=0,pt=0,ni=1e3,$t,yt,Yt=0,tt=0,ee=0,Bt=typeof performance=="object"&&performance.now?performance:Date,ii=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Se(){return tt||(ii(No),tt=Bt.now()+ee)}function No(){tt=0}function Zt(){this._call=this._time=this._next=null}Zt.prototype=Le.prototype={constructor:Zt,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Se():+n)+(e==null?0:+e),!this._next&&yt!==this&&(yt?yt._next=this:$t=this,yt=this),this._call=t,this._time=n,ye()},stop:function(){this._call&&(this._call=null,this._time=1/0,ye())}};function Le(t,e,n){var i=new Zt;return i.restart(t,e,n),i}function Ro(){Se(),++ht;for(var t=$t,e;t;)(e=tt-t._time)>=0&&t._call.call(void 0,e),t=t._next;--ht}function pn(){tt=(Yt=Bt.now())+ee,ht=vt=0;try{Ro()}finally{ht=0,Mo(),tt=0}}function To(){var t=Bt.now(),e=t-Yt;e>ni&&(ee-=e,Yt=t)}function Mo(){for(var t,e=$t,n,i=1/0;e;)e._call?(i>e._time&&(i=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:$t=n);yt=t,ye(i)}function ye(t){if(!ht){vt&&(vt=clearTimeout(vt));var e=t-tt;e>24?(t<1/0&&(vt=setTimeout(pn,t-Bt.now()-ee)),pt&&(pt=clearInterval(pt))):(pt||(Yt=Bt.now(),pt=setInterval(To,ni)),ht=1,ii(pn))}}function gn(t,e,n){var i=new Zt;return e=e==null?0:+e,i.restart(r=>{i.stop(),t(r+e)},e,n),i}var ko=Te("start","end","cancel","interrupt"),Ho=[],ri=0,An=1,me=2,Vt=3,vn=4,xe=5,Ot=6;function ne(t,e,n,i,r,s){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;So(t,n,{name:e,index:i,group:r,on:ko,tween:Ho,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:ri})}function Pe(t,e){var n=P(t,e);if(n.state>ri)throw new Error("too late; already scheduled");return n}function V(t,e){var n=P(t,e);if(n.state>Vt)throw new Error("too late; already running");return n}function P(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function So(t,e,n){var i=t.__transition,r;i[e]=n,n.timer=Le(s,0,n.time);function s(c){n.state=An,n.timer.restart(o,n.delay,n.time),n.delay<=c&&o(c-n.delay)}function o(c){var u,f,h,d;if(n.state!==An)return l();for(u in i)if(d=i[u],d.name===n.name){if(d.state===Vt)return gn(o);d.state===vn?(d.state=Ot,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete i[u]):+u<e&&(d.state=Ot,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete i[u])}if(gn(function(){n.state===Vt&&(n.state=vn,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=me,n.on.call("start",t,t.__data__,n.index,n.group),n.state===me){for(n.state=Vt,r=new Array(h=n.tween.length),u=0,f=-1;u<h;++u)(d=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++f]=d);r.length=f+1}}function a(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=xe,1),f=-1,h=r.length;++f<h;)r[f].call(t,u);n.state===xe&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=Ot,n.timer.stop(),delete i[e];for(var c in i)return;delete t.__transition}}function Lo(t,e){var n=t.__transition,i,r,s=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((i=n[o]).name!==e){s=!1;continue}r=i.state>me&&i.state<xe,i.state=Ot,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete n[o]}s&&delete t.__transition}}function Po(t){return this.each(function(){Lo(this,t)})}function Qo(t,e){var n,i;return function(){var r=V(this,t),s=r.tween;if(s!==n){i=n=s;for(var o=0,a=i.length;o<a;++o)if(i[o].name===e){i=i.slice(),i.splice(o,1);break}}r.tween=i}}function Xo(t,e,n){var i,r;if(typeof n!="function")throw new Error;return function(){var s=V(this,t),o=s.tween;if(o!==i){r=(i=o).slice();for(var a={name:e,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=a;break}l===c&&r.push(a)}s.tween=r}}function Vo(t,e){var n=this._id;if(t+="",arguments.length<2){for(var i=P(this.node(),n).tween,r=0,s=i.length,o;r<s;++r)if((o=i[r]).name===t)return o.value;return null}return this.each((e==null?Qo:Xo)(n,t,e))}function Qe(t,e,n){var i=t._id;return t.each(function(){var r=V(this,i);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return P(r,i).value[e]}}function si(t,e){var n;return(typeof e=="number"?D:e instanceof It?fn:(n=It(e))?(e=n,fn):bo)(t,e)}function Oo(t){return function(){this.removeAttribute(t)}}function Fo(t){return function(){this.removeAttributeNS(t.space,t.local)}}function zo(t,e,n){var i,r=n+"",s;return function(){var o=this.getAttribute(t);return o===r?null:o===i?s:s=e(i=o,n)}}function Wo(t,e,n){var i,r=n+"",s;return function(){var o=this.getAttributeNS(t.space,t.local);return o===r?null:o===i?s:s=e(i=o,n)}}function Do(t,e,n){var i,r,s;return function(){var o,a=n(this),l;return a==null?void this.removeAttribute(t):(o=this.getAttribute(t),l=a+"",o===l?null:o===i&&l===r?s:(r=l,s=e(i=o,a)))}}function Go(t,e,n){var i,r,s;return function(){var o,a=n(this),l;return a==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),l=a+"",o===l?null:o===i&&l===r?s:(r=l,s=e(i=o,a)))}}function Uo(t,e){var n=te(t),i=n==="transform"?Bo:si;return this.attrTween(t,typeof e=="function"?(n.local?Go:Do)(n,i,Qe(this,"attr."+t,e)):e==null?(n.local?Fo:Oo)(n):(n.local?Wo:zo)(n,i,e))}function $o(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function Yo(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function Zo(t,e){var n,i;function r(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&Yo(t,s)),n}return r._value=e,r}function Ko(t,e){var n,i;function r(){var s=e.apply(this,arguments);return s!==i&&(n=(i=s)&&$o(t,s)),n}return r._value=e,r}function qo(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var i=te(t);return this.tween(n,(i.local?Zo:Ko)(i,e))}function Jo(t,e){return function(){Pe(this,t).delay=+e.apply(this,arguments)}}function jo(t,e){return e=+e,function(){Pe(this,t).delay=e}}function ta(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?Jo:jo)(e,t)):P(this.node(),e).delay}function ea(t,e){return function(){V(this,t).duration=+e.apply(this,arguments)}}function na(t,e){return e=+e,function(){V(this,t).duration=e}}function ia(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?ea:na)(e,t)):P(this.node(),e).duration}function ra(t,e){if(typeof e!="function")throw new Error;return function(){V(this,t).ease=e}}function sa(t){var e=this._id;return arguments.length?this.each(ra(e,t)):P(this.node(),e).ease}function oa(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;V(this,t).ease=n}}function aa(t){if(typeof t!="function")throw new Error;return this.each(oa(this._id,t))}function la(t){typeof t!="function"&&(t=On(t));for(var e=this._groups,n=e.length,i=new Array(n),r=0;r<n;++r)for(var s=e[r],o=s.length,a=i[r]=[],l,c=0;c<o;++c)(l=s[c])&&t.call(l,l.__data__,c,s)&&a.push(l);return new z(i,this._parents,this._name,this._id)}function ca(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,i=e.length,r=n.length,s=Math.min(i,r),o=new Array(i),a=0;a<s;++a)for(var l=e[a],c=n[a],u=l.length,f=o[a]=new Array(u),h,d=0;d<u;++d)(h=l[d]||c[d])&&(f[d]=h);for(;a<i;++a)o[a]=e[a];return new z(o,this._parents,this._name,this._id)}function ua(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function ha(t,e,n){var i,r,s=ua(e)?Pe:V;return function(){var o=s(this,t),a=o.on;a!==i&&(r=(i=a).copy()).on(e,n),o.on=r}}function fa(t,e){var n=this._id;return arguments.length<2?P(this.node(),n).on.on(t):this.each(ha(n,t,e))}function da(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function pa(){return this.on("end.remove",da(this._id))}function ga(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Me(t));for(var i=this._groups,r=i.length,s=new Array(r),o=0;o<r;++o)for(var a=i[o],l=a.length,c=s[o]=new Array(l),u,f,h=0;h<l;++h)(u=a[h])&&(f=t.call(u,u.__data__,h,a))&&("__data__"in u&&(f.__data__=u.__data__),c[h]=f,ne(c[h],e,n,h,c,P(u,n)));return new z(s,this._parents,e,n)}function Aa(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Vn(t));for(var i=this._groups,r=i.length,s=[],o=[],a=0;a<r;++a)for(var l=i[a],c=l.length,u,f=0;f<c;++f)if(u=l[f]){for(var h=t.call(u,u.__data__,f,l),d,y=P(u,n),g=0,p=h.length;g<p;++g)(d=h[g])&&ne(d,e,n,g,h,y);s.push(h),o.push(u)}return new z(s,o,e,n)}var va=Rt.prototype.constructor;function ya(){return new va(this._groups,this._parents)}function ma(t,e){var n,i,r;return function(){var s=ut(this,t),o=(this.style.removeProperty(t),ut(this,t));return s===o?null:s===n&&o===i?r:r=e(n=s,i=o)}}function oi(t){return function(){this.style.removeProperty(t)}}function xa(t,e,n){var i,r=n+"",s;return function(){var o=ut(this,t);return o===r?null:o===i?s:s=e(i=o,n)}}function _a(t,e,n){var i,r,s;return function(){var o=ut(this,t),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(t),ut(this,t))),o===l?null:o===i&&l===r?s:(r=l,s=e(i=o,a))}}function wa(t,e){var n,i,r,s="style."+e,o="end."+s,a;return function(){var l=V(this,t),c=l.on,u=l.value[s]==null?a||(a=oi(e)):void 0;(c!==n||r!==u)&&(i=(n=c).copy()).on(o,r=u),l.on=i}}function ba(t,e,n){var i=(t+="")=="transform"?Io:si;return e==null?this.styleTween(t,ma(t,i)).on("end.style."+t,oi(t)):typeof e=="function"?this.styleTween(t,_a(t,i,Qe(this,"style."+t,e))).each(wa(this._id,t)):this.styleTween(t,xa(t,i,e),n).on("end.style."+t,null)}function Ea(t,e,n){return function(i){this.style.setProperty(t,e.call(this,i),n)}}function Ca(t,e,n){var i,r;function s(){var o=e.apply(this,arguments);return o!==r&&(i=(r=o)&&Ea(t,o,n)),i}return s._value=e,s}function Ia(t,e,n){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(e==null)return this.tween(i,null);if(typeof e!="function")throw new Error;return this.tween(i,Ca(t,e,n??""))}function Ba(t){return function(){this.textContent=t}}function Na(t){return function(){var e=t(this);this.textContent=e??""}}function Ra(t){return this.tween("text",typeof t=="function"?Na(Qe(this,"text",t)):Ba(t==null?"":t+""))}function Ta(t){return function(e){this.textContent=t.call(this,e)}}function Ma(t){var e,n;function i(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&Ta(r)),e}return i._value=t,i}function ka(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,Ma(t))}function Ha(){for(var t=this._name,e=this._id,n=ai(),i=this._groups,r=i.length,s=0;s<r;++s)for(var o=i[s],a=o.length,l,c=0;c<a;++c)if(l=o[c]){var u=P(l,e);ne(l,t,n,c,o,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new z(i,this._parents,t,n)}function Sa(){var t,e,n=this,i=n._id,r=n.size();return new Promise(function(s,o){var a={value:o},l={value:function(){--r===0&&s()}};n.each(function(){var c=V(this,i),u=c.on;u!==t&&(e=(t=u).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),c.on=e}),r===0&&s()})}var La=0;function z(t,e,n,i){this._groups=t,this._parents=e,this._name=n,this._id=i}function ai(){return++La}var O=Rt.prototype;z.prototype={constructor:z,select:ga,selectAll:Aa,selectChild:O.selectChild,selectChildren:O.selectChildren,filter:la,merge:ca,selection:ya,transition:Ha,call:O.call,nodes:O.nodes,node:O.node,size:O.size,empty:O.empty,each:O.each,on:fa,attr:Uo,attrTween:qo,style:ba,styleTween:Ia,text:Ra,textTween:ka,remove:pa,tween:Vo,delay:ta,duration:ia,ease:sa,easeVarying:aa,end:Sa,[Symbol.iterator]:O[Symbol.iterator]};function Pa(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Qa={time:null,delay:0,duration:250,ease:Pa};function Xa(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function Va(t){var e,n;t instanceof z?(e=t._id,t=t._name):(e=ai(),(n=Qa).time=Se(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,s=0;s<r;++s)for(var o=i[s],a=o.length,l,c=0;c<a;++c)(l=o[c])&&ne(l,t,e,c,o,n||Xa(l,e));return new z(i,this._parents,t,e)}Rt.prototype.interrupt=Po;Rt.prototype.transition=Va;const _e=Math.PI,we=2*_e,Z=1e-6,Oa=we-Z;function li(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function Fa(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return li;const n=10**e;return function(i){this._+=i[0];for(let r=1,s=i.length;r<s;++r)this._+=Math.round(arguments[r]*n)/n+i[r]}}class za{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?li:Fa(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,i,r){this._append`Q${+e},${+n},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(e,n,i,r,s,o){this._append`C${+e},${+n},${+i},${+r},${this._x1=+s},${this._y1=+o}`}arcTo(e,n,i,r,s){if(e=+e,n=+n,i=+i,r=+r,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,a=this._y1,l=i-e,c=r-n,u=o-e,f=a-n,h=u*u+f*f;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(h>Z)if(!(Math.abs(f*l-c*u)>Z)||!s)this._append`L${this._x1=e},${this._y1=n}`;else{let d=i-o,y=r-a,g=l*l+c*c,p=d*d+y*y,v=Math.sqrt(g),m=Math.sqrt(h),w=s*Math.tan((_e-Math.acos((g+h-p)/(2*v*m)))/2),x=w/m,b=w/v;Math.abs(x-1)>Z&&this._append`L${e+x*u},${n+x*f}`,this._append`A${s},${s},0,0,${+(f*d>u*y)},${this._x1=e+b*l},${this._y1=n+b*c}`}}arc(e,n,i,r,s,o){if(e=+e,n=+n,i=+i,o=!!o,i<0)throw new Error(`negative radius: ${i}`);let a=i*Math.cos(r),l=i*Math.sin(r),c=e+a,u=n+l,f=1^o,h=o?r-s:s-r;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>Z||Math.abs(this._y1-u)>Z)&&this._append`L${c},${u}`,i&&(h<0&&(h=h%we+we),h>Oa?this._append`A${i},${i},0,1,${f},${e-a},${n-l}A${i},${i},0,1,${f},${this._x1=c},${this._y1=u}`:h>Z&&this._append`A${i},${i},0,${+(h>=_e)},${f},${this._x1=e+i*Math.cos(s)},${this._y1=n+i*Math.sin(s)}`)}rect(e,n,i,r){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}}const Wa=1664525,Da=1013904223,yn=4294967296;function Ga(){let t=1;return()=>(t=(Wa*t+Da)%yn)/yn}var Ua=10,$a=Math.PI*(3-Math.sqrt(5));function Ya(t){var e,n=1,i=.001,r=1-Math.pow(i,1/300),s=0,o=.6,a=new Map,l=Le(f),c=Te("tick","end"),u=Ga();t==null&&(t=[]);function f(){h(),c.call("tick",e),n<i&&(l.stop(),c.call("end",e))}function h(g){var p,v=t.length,m;g===void 0&&(g=1);for(var w=0;w<g;++w)for(n+=(s-n)*r,a.forEach(function(x){x(n)}),p=0;p<v;++p)m=t[p],m.fx==null?m.x+=m.vx*=o:(m.x=m.fx,m.vx=0),m.fy==null?m.y+=m.vy*=o:(m.y=m.fy,m.vy=0);return e}function d(){for(var g=0,p=t.length,v;g<p;++g){if(v=t[g],v.index=g,v.fx!=null&&(v.x=v.fx),v.fy!=null&&(v.y=v.fy),isNaN(v.x)||isNaN(v.y)){var m=Ua*Math.sqrt(.5+g),w=g*$a;v.x=m*Math.cos(w),v.y=m*Math.sin(w)}(isNaN(v.vx)||isNaN(v.vy))&&(v.vx=v.vy=0)}}function y(g){return g.initialize&&g.initialize(t,u),g}return d(),e={tick:h,restart:function(){return l.restart(f),e},stop:function(){return l.stop(),e},nodes:function(g){return arguments.length?(t=g,d(),a.forEach(y),e):t},alpha:function(g){return arguments.length?(n=+g,e):n},alphaMin:function(g){return arguments.length?(i=+g,e):i},alphaDecay:function(g){return arguments.length?(r=+g,e):+r},alphaTarget:function(g){return arguments.length?(s=+g,e):s},velocityDecay:function(g){return arguments.length?(o=1-g,e):1-o},randomSource:function(g){return arguments.length?(u=g,a.forEach(y),e):u},force:function(g,p){return arguments.length>1?(p==null?a.delete(g):a.set(g,y(p)),e):a.get(g)},find:function(g,p,v){var m=0,w=t.length,x,b,B,T,H;for(v==null?v=1/0:v*=v,m=0;m<w;++m)T=t[m],x=g-T.x,b=p-T.y,B=x*x+b*b,B<v&&(H=T,v=B);return H},on:function(g,p){return arguments.length>1?(c.on(g,p),e):c.on(g)}}}function st(t){return function(){return t}}const mn=1e-12;function Za(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const i=Math.floor(n);if(!(i>=0))throw new RangeError(`invalid digits: ${n}`);e=i}return t},()=>new za(e)}function Ka(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function ci(t){this._context=t}ci.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function qa(t){return new ci(t)}function Ja(t){return t[0]}function ja(t){return t[1]}function tl(t,e){var n=st(!0),i=null,r=qa,s=null,o=Za(a);t=typeof t=="function"?t:t===void 0?Ja:st(t),e=typeof e=="function"?e:e===void 0?ja:st(e);function a(l){var c,u=(l=Ka(l)).length,f,h=!1,d;for(i==null&&(s=r(d=o())),c=0;c<=u;++c)!(c<u&&n(f=l[c],c,l))===h&&((h=!h)?s.lineStart():s.lineEnd()),h&&s.point(+t(f,c,l),+e(f,c,l));if(d)return s=null,d+""||null}return a.x=function(l){return arguments.length?(t=typeof l=="function"?l:st(+l),a):t},a.y=function(l){return arguments.length?(e=typeof l=="function"?l:st(+l),a):e},a.defined=function(l){return arguments.length?(n=typeof l=="function"?l:st(!!l),a):n},a.curve=function(l){return arguments.length?(r=l,i!=null&&(s=r(i)),a):r},a.context=function(l){return arguments.length?(l==null?i=s=null:s=r(i=l),a):i},a}function be(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function Xe(t,e){this._context=t,this._k=(1-e)/6}Xe.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:be(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:be(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(i){return new Xe(i,e)}return n.tension=function(i){return t(+i)},n})(0);function Ve(t,e){this._context=t,this._k=(1-e)/6}Ve.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:be(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(i){return new Ve(i,e)}return n.tension=function(i){return t(+i)},n})(0);function ui(t,e,n){var i=t._x1,r=t._y1,s=t._x2,o=t._y2;if(t._l01_a>mn){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,l=3*t._l01_a*(t._l01_a+t._l12_a);i=(i*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/l,r=(r*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/l}if(t._l23_a>mn){var c=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,u=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*c+t._x1*t._l23_2a-e*t._l12_2a)/u,o=(o*c+t._y1*t._l23_2a-n*t._l12_2a)/u}t._context.bezierCurveTo(i,r,s,o,t._x2,t._y2)}function hi(t,e){this._context=t,this._alpha=e}hi.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:ui(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};(function t(e){function n(i){return e?new hi(i,e):new Xe(i,0)}return n.alpha=function(i){return t(+i)},n})(.5);function fi(t,e){this._context=t,this._alpha=e}fi.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,i=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+i*i,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:ui(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const el=function t(e){function n(i){return e?new fi(i,e):new Ve(i,0)}return n.alpha=function(i){return t(+i)},n}(.5);function mt(t,e,n){this.k=t,this.x=e,this.y=n}mt.prototype={constructor:mt,scale:function(t){return t===1?this:new mt(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new mt(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};mt.prototype;const nl=1,il=0,Pt=4,xn=14,_n=12,wn=15,rl=1.3,sl=.1,gt=6,ol=1,al=12;function ll(t,e,n){let i=!0,r=!1;const s=new gr(t.pad(il,Pt,0)),o=new fr(s),a=new xr(o.cn),l=ro("#simulation");l.attr("viewBox",`${-wn} 0 ${_n*(s.width+2)*2} ${xn*s.height}`);const c=e.toReversed();function u(A){return A<Pt||A>=s.height-Pt?"#00000055":n[c[(A-Pt)%c.length]]}function f(A){return A.contactNodes.forEach((E,et)=>{const $=et%A.width,nt=(et-$)/A.width;E.i=$,E.j=nt,E.x=wn+$*_n,E.y=(A.height-nt)*xn}),A.contactNodes}const h=f(a),d=a.makeNice(),y=a.yarnPathToLinks(),g=l.append("g"),p=l.append("g"),v=l.append("g");function m(A){return h[A.source].st=="K"&&h[A.target].st=="K"?A.linkType=="LHLL"||A.linkType=="FLFH"?"front":"back":h[A.source].st=="P"&&h[A.target].st=="P"?A.linkType=="LHLL"||A.linkType=="FLFH"?"back":"front":"mid"}const w=g.attr("stroke-width",gt).attr("stroke-linecap","round").selectAll().data(y).join("path").filter(A=>m(A)=="back").attr("data-link",A=>A.linkType).attr("fill","none").attr("stroke",A=>u(A.row)),x=p.attr("filter","brightness(0.9)").attr("stroke-width",gt).attr("stroke-linecap","round").selectAll().data(y).join("path").filter(A=>m(A)=="mid").attr("data-link",A=>A.linkType).attr("fill","none").attr("stroke",A=>u(A.row)),b=v.attr("stroke-width",gt).attr("stroke-linecap","round").selectAll().data(y.toReversed()).join("path").filter(A=>m(A)=="front").attr("data-link",A=>A.linkType).attr("fill","none").attr("stroke",A=>u(A.row));function B(A,E,et){if(A.index===E.index)return[0,0];const $=A.x-E.x,nt=A.y-E.y,kt=rl*Math.sqrt($**2+nt**2);return et?[-nt/kt,$/kt]:[nt/kt,-$/kt]}function T(){d[0].normal=B(h[d[0].cnIndex],h[d[1].cnIndex],!0);for(let A=1;A<d.length-1;A++){let E;d[A].cnType=="FH"||d[A].cnType=="LH"?d[A].row%2==0?E=!0:E=!1:d[A].row%2==0?E=!1:E=!0,d[A].normal=B(h[d[A-1].cnIndex],h[d[A+1].cnIndex],E)}d.at(-1).normal=B(h[d.at(-2).cnIndex],h[d.at(-1).cnIndex],!0)}const H=tl().x(A=>h[A.cnIndex].x+gt/2*A.normal[0]).y(A=>h[A.cnIndex].y+gt/2*A.normal[1]).curve(el);function N(A){const E=A.index;if(E==0||E>y.length-3)return`M ${A.source.x} ${A.source.y} ${A.target.x} ${A.target.y}`;const et=[d[E-1],d[E],d[E+1],d[E+2]];return H(et)}function W(){T(),b.attr("d",N),x.attr("d",N),w.attr("d",N)}W(),Oe();function gi(){l.selectAll("*").remove()}function Ai(){r||(Ya(h).force("link",wr(y).strength(sl).iterations(nl).distance(A=>A.linkType=="FLFH"||A.linkType=="LHLL"?al:Math.abs(A.source.x-A.target.x)*ol)).on("tick",W),r=!0)}function Oe(){p.raise(),v.raise(),g.attr("filter","brightness(0.7)"),v.attr("filter","none"),l.attr("transform","scale(-1,1)")}function vi(){p.raise(),g.raise(),v.attr("filter","brightness(0.7)"),g.attr("filter","none"),l.attr("transform",null)}function yi(){i=!i,i?Oe():vi()}return{clear:gi,relax:Ai,flip:yi}}const cl={flood:"fa-fill-drip",brush:"fa-paintbrush",rect:"fa-vector-square",line:"fa-minus",shift:"fa-up-down-left-right"};let _=ji;_.mouseDown=0;document.body.onmousedown=function(){++_.mouseDown};document.body.onmouseup=function(){--_.mouseDown};let Qt,di,pi,ce,Ft,bn,Kt,S,xt,at;function ul(){return k`
    <div id="site-content">
      <div id="site-title" style="grid-area: title;">
        <span>knitscape</span>
      </div>

      <div id="left-controls" style="grid-area: lcontrols;">
        <button
          @click=${()=>{_.scale=_.scale+1,Ee()}}>
          <i class="fa-solid fa-magnifying-glass-plus"></i>
        </button>
        <button
          @click=${()=>{_.scale=_.scale-1,Ee()}}>
          <i class="fa-solid fa-magnifying-glass-minus"></i>
        </button>
        <div id="repeat-tools"></div>
        <div id="repeat-palette"></div>
        <div id="repeat-height"></div>
      </div>
      <div class="lgutter" style="grid-area: lgutter;">
        <div class="preview"></div>
        <div class="repeat"></div>
      </div>
      <div id="pattern-container" style="grid-area: pattern;">
        <canvas id="preview"></canvas>
        <canvas id="repeat"></canvas>
      </div>
      <div class="bgutter" style="grid-area: bgutter;">
        <div class="preview"></div>
        <div class="repeat"></div>
      </div>
      <!-- <div style="grid-area: needles;">
        <canvas id="needle-work-editor"></canvas>
      </div> -->
      <div id="bottom-controls" style="grid-area: bcontrols;">
        <div id="repeat-width"></div>
      </div>

      <div id="color-change-container" style="grid-area: colors;">
        <canvas id="color-change-editor" height="25" width="25"></canvas>
        <div id="color-controls">
          <div id="yarn-palette"></div>
          <div id="color-height"></div>
        </div>
      </div>

      <div id="sim-container" style="grid-area: sim">
        <div id="sim-controls" style="grid-area: simcontrols">
          <button @click=${()=>di()}>relax</button>
          <button @click=${()=>pi()}>flip</button>
        </div>
        <svg id="simulation"></svg>
      </div>
    </div>
  `}function qt({bitmap:t},e){if(e=="horizontal")return Array.apply(null,Array(t.width)).map((n,i)=>i+1);if(e=="vertical")return Array.apply(null,Array(t.height)).map((n,i)=>i+1).reverse()}function Jt({gutterFunc:t,container:e,axis:n}){return(i,r)=>{let s=t(i,n);function o(a){return n=="horizontal"&&i.pos.x==a?!0:n=="vertical"&&i.pos.y==a}U(k`<div class="gutter ${n}" style="--scale:${i.scale}px;">
        ${s.map((a,l)=>k`<div class="cell ${o(l)?"highlight":""}">
              ${a}
            </div>`)}
      </div>`,e)}}function hl({container:t}){return(e,n)=>{let{bitmap:i}=e;U(k`<div class="spinner horizontal">
        <button
          class="minus"
          @click=${()=>n({bitmap:i.resize(i.width-1,i.height)})}>
          <i class="fa-solid fa-minus"></i>
        </button>

        <input
          type="text"
          .value=${Ce(i.width)}
          class="size-input"
          @change=${r=>n({bitmap:i.resize(Number(r.target.value),i.height)})} />
        <button
          class="plus"
          @click=${()=>n({bitmap:i.resize(i.width+1,i.height)})}>
          <i class="fa-solid fa-plus"></i>
        </button>
      </div>`,t)}}function fl({container:t}){return(e,n)=>{let{bitmap:i}=e;U(k`<div class="spinner vertical">
        <button
          class="plus"
          @click=${()=>n({bitmap:i.resize(i.width,i.height+1)})}>
          <i class="fa-solid fa-plus"></i>
        </button>
        <input
          type="text"
          .value=${Ce(i.height)}
          class="size-input"
          @change=${r=>n({bitmap:i.resize(i.width,Number(r.target.value))})} />

        <button
          class="minus"
          @click=${()=>n({bitmap:i.resize(i.width,i.height-1)})}>
          <i class="fa-solid fa-minus"></i>
        </button>
      </div>`,t)}}function dl(t,e){return(n,i)=>U(k`<div class="tool-select">
        ${Object.keys(t).map(r=>k`<button
              class=${n.activeTool==r?"active":""}
              @click=${()=>i({activeTool:r})}>
              <i class="fa-solid ${cl[r]}"></i>
            </button>`)}
      </div>`,e)}function pl(t,e){return(n,i)=>U(k`
        <div class="palette-select">
          ${t.map(({image:r,title:s},o)=>k`<img
                class=${o==n.paletteIndex?"selected":""}
                src=${r.src}
                title=${s}
                @click=${()=>i({paletteIndex:o})} />`)}
        </div>
      `,e)}async function gl(){let t={brush:Mn,flood:Wi,line:Gi,rect:Di,shift:Ui};const e=await rr();return new Ie({state:{bitmap:C.fromJSON(_.repeat),palette:e,canvas:Ft},components:[Ne({target:Ft}),Be(),he({tools:t,eventTarget:Ft}),he({tools:t,eventTarget:Kt}),Wt({drawFunc:Tn}),Re(),Nn(),Q({check:Ye("activeTool"),cb:dl(t,document.getElementById("repeat-tools"))}),Q({check:Ye("paletteIndex"),cb:pl(e,document.getElementById("repeat-palette"))}),Q({cb:Jt({gutterFunc:qt,container:document.querySelector(".bgutter .repeat"),axis:"horizontal"})}),Q({cb:Jt({gutterFunc:qt,container:document.querySelector(".lgutter .repeat"),axis:"vertical"})}),Q({cb:fl({container:document.getElementById("repeat-height")})}),Q({cb:hl({container:document.getElementById("repeat-width")})})]})}async function Al(){const t=await sr(),{colorLayer:e,symbolLayer:n}=Mt(C.fromJSON(_.repeat),_.previewX,_.previewY,_.yarns.pixels);return new Ie({state:{bitmap:e,symbolMap:n,scale:_.scale,palette:_.yarnPalette,stitchPalette:t,canvas:Kt},components:[Ne({target:Kt}),Be(),Wt({drawFunc:Rn}),Wt({drawFunc:Tn,paletteOverride:"stitchPalette",bitmapOverride:"symbolMap"}),Re(),Nn(),Q({cb:Jt({gutterFunc:qt,container:document.querySelector(".bgutter .preview"),axis:"horizontal"})}),Q({cb:Jt({gutterFunc:qt,container:document.querySelector(".lgutter .preview"),axis:"vertical"})})]})}function vl(t){const{colorLayer:e,symbolLayer:n}=Mt(C.fromJSON(t.bitmap),_.previewX,_.previewY,_.yarns.pixels);at.dispatch({bitmap:e,symbolMap:n}),ie(n)}function yl(t){_.yarns.pixels=t.bitmap.vMirror().pixels;const{colorLayer:e,symbolLayer:n}=Mt(C.fromJSON(S.state.bitmap),_.previewX,_.previewY,_.yarns.pixels);at.dispatch({bitmap:e,symbolMap:n}),ie(n)}function Ee(){const t=document.getElementById("pattern-container").getBoundingClientRect();_.previewX=Math.floor(t.width/_.scale),_.previewY=Math.floor(t.height/_.scale);const e=_.scale,{colorLayer:n,symbolLayer:i}=Mt(C.fromJSON(S.state.bitmap),_.previewX,_.previewY,_.yarns.pixels);S.dispatch({scale:e}),xt.dispatch({scale:e}),at.dispatch({scale:e,bitmap:n,symbolMap:i}),ie(i)}function Mt(t,e,n,i){let r=C.fromTile(e,n,t.vMirror()),s=[],o=[];for(let c=0;c<n;c++)for(let u=0;u<e;u++)s.push(i[c%i.length]),o.push(r.pixel(u,c));let a=new C(e,n,s),l=new C(e,n,o);return{colorLayer:a.vMirror(),symbolLayer:l.vMirror()}}function ie(t){ce&&clearTimeout(ce),ce=setTimeout(()=>{Qt&&Qt(),Qt=null,{clear:Qt,relax:di,flip:pi}=ll(t,xt.state.bitmap.pixels,_.yarnPalette)},200)}async function ml(){U(ul(),document.body),Ft=document.getElementById("repeat"),bn=document.getElementById("color-change-editor"),Kt=document.getElementById("preview"),document.getElementById("needle-work-editor"),S=await gl(),xt=lr(_,bn),at=await Al(),S.addEffect("bitmap",vl),xt.addEffect("bitmap",yl),xt.addEffect("palette",({palette:t})=>{_.yarnPalette=t,at.dispatch({palette:t});const{symbolLayer:e}=Mt(C.fromJSON(S.state.bitmap),_.previewX,_.previewY,_.yarns.pixels);ie(e)}),at.addEffect("pos",({bitmap:t,pos:e})=>{if(e.x>-1||e.y>-1){let n=e.x%S.state.bitmap.width,i=S.state.bitmap.height-(t.height-e.y)%S.state.bitmap.height;i=i==S.state.bitmap.height?0:i,S.dispatch({pos:{x:n,y:i}})}}),Ee()}window.onload=ml;
